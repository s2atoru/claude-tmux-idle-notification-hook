# tmux-idle-notification

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![GitHub stars](https://img.shields.io/github/stars/s2atoru/claude-tmux-idle-notification-hook.svg)](https://github.com/s2atoru/claude-tmux-idle-notification-hook/stargazers)
[![GitHub forks](https://img.shields.io/github/forks/s2atoru/claude-tmux-idle-notification-hook.svg)](https://github.com/s2atoru/claude-tmux-idle-notification-hook/network)
[![GitHub issues](https://img.shields.io/github/issues/s2atoru/claude-tmux-idle-notification-hook.svg)](https://github.com/s2atoru/claude-tmux-idle-notification-hook/issues)

iTerm2ã¨tmuxã§ã‚¢ã‚¤ãƒ‰ãƒ«çŠ¶æ…‹ã‚’æ¤œå‡ºã—ã€macOSé€šçŸ¥ã‚’é€ä¿¡ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚

![Platform](https://img.shields.io/badge/platform-macOS-lightgrey.svg)
![Shell](https://img.shields.io/badge/shell-bash-green.svg)
![iTerm2](https://img.shields.io/badge/iTerm2-required-blue.svg)

## ç›®æ¬¡

- [æ¦‚è¦](#æ¦‚è¦)
- [æ©Ÿèƒ½](#æ©Ÿèƒ½)
- [ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ](#ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ)
- [ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ](#ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ)
- [ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—](#ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—)
- [ä½¿ã„æ–¹](#ä½¿ã„æ–¹)
- [ã‚¹ã‚¯ãƒªãƒ—ãƒˆè©³ç´°](#ã‚¹ã‚¯ãƒªãƒ—ãƒˆè©³ç´°)
- [é€šçŸ¥ã®ä»•çµ„ã¿](#é€šçŸ¥ã®ä»•çµ„ã¿)
- [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
- [ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º](#ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º)
- [ä»Šå¾Œã®æ”¹å–„æ¡ˆ](#ä»Šå¾Œã®æ”¹å–„æ¡ˆ)
- [è²¢çŒ®](#è²¢çŒ®)
- [ãƒ©ã‚¤ã‚»ãƒ³ã‚¹](#ãƒ©ã‚¤ã‚»ãƒ³ã‚¹)
- [ä½œè€…](#ä½œè€…)
- [å‚è€ƒè³‡æ–™](#å‚è€ƒè³‡æ–™)

## æ¦‚è¦

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯2ã¤ã®é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã‚’æä¾›ã—ã¾ã™ï¼š

1. **tmuxã‚¢ã‚¤ãƒ‰ãƒ«ç›£è¦–** - tmuxã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒã‚¢ã‚¤ãƒ‰ãƒ«çŠ¶æ…‹ã«ãªã£ãŸã¨ãã«é€šçŸ¥
2. **Claude Codeå®Œäº†é€šçŸ¥** - Claude CodeãŒã‚¿ã‚¹ã‚¯ã‚’å®Œäº†ã—ãŸã¨ãã«é€šçŸ¥

ã©ã¡ã‚‰ã‚‚iTerm2ã®`TMUX_IDLE_NOTIFICATION:`ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’ä½¿ç”¨ã—ã¦ã€macOSé€šçŸ¥ã‚»ãƒ³ã‚¿ãƒ¼ã«é€šçŸ¥ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

### å‹•ä½œã‚¤ãƒ¡ãƒ¼ã‚¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    tmux + iTerm2                            â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                      â”‚
â”‚  â”‚  tmux session    â”‚                                      â”‚
â”‚  â”‚  (idle 60s+)     â”‚                                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â”‚           â”‚                                                 â”‚
â”‚           â–¼                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ tmux-idle-check  â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚ TMUX_IDLE_       â”‚          â”‚
â”‚  â”‚     .sh          â”‚       â”‚ NOTIFICATION:    â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                       â”‚                     â”‚
â”‚           Claude Code                 â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚                     â”‚
â”‚  â”‚  Task completed  â”‚                â”‚                     â”‚
â”‚  â”‚  (idle 60s+)     â”‚                â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚                     â”‚
â”‚           â”‚                           â”‚                     â”‚
â”‚           â–¼                           â”‚                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚                     â”‚
â”‚  â”‚claude-complete-  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚  â”‚   notify.sh      â”‚                                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
â”‚                                                             â”‚
â”‚                           â”‚                                 â”‚
â”‚                           â–¼                                 â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                  â”‚  iTerm2 detects â”‚                       â”‚
â”‚                  â”‚  prefix pattern â”‚                       â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  macOS           â”‚
                   â”‚  Notification    â”‚
                   â”‚  Center          â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ©Ÿèƒ½

### 1. tmuxã‚¢ã‚¤ãƒ‰ãƒ«ç›£è¦–

- tmuxã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æœ€çµ‚ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’ç›£è¦–
- æŒ‡å®šæ™‚é–“ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ60ç§’ï¼‰ã‚¢ã‚¤ãƒ‰ãƒ«çŠ¶æ…‹ãŒç¶šãã¨é€šçŸ¥
- ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«æˆ»ã‚‹ã¨é€šçŸ¥ãƒ•ãƒ©ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆ
- ã‚»ãƒƒã‚·ãƒ§ãƒ³å˜ä½ã§å‹•ä½œ

### 2. Claude Codeå®Œäº†é€šçŸ¥

- Claude CodeãŒã‚¿ã‚¹ã‚¯å®Œäº†å¾Œã€60ç§’é–“ã‚¢ã‚¤ãƒ‰ãƒ«çŠ¶æ…‹ã«ãªã‚‹ã¨é€šçŸ¥
- Claude Code hookã‚·ã‚¹ãƒ†ãƒ ã¨çµ±åˆ
- tmuxç’°å¢ƒã§ã®ã¿å‹•ä½œï¼ˆç¾åœ¨ã®å®Ÿè£…ï¼‰

## ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
tmux-idle-notification/
â”œâ”€â”€ README.md                           # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ tmux-idle-check.sh                  # ã‚¢ã‚¤ãƒ‰ãƒ«ç›£è¦–ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ tmux-idle-check-launcher.sh         # ãƒ©ãƒ³ãƒãƒ£ãƒ¼ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â”œâ”€â”€ claude-notification-dynamic.sh      # Claude Codeå‹•çš„é€šçŸ¥ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆæ¨å¥¨ï¼‰
â””â”€â”€ claude-complete-notify.sh           # Claude Codeé€šçŸ¥ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆãƒ¬ã‚¬ã‚·ãƒ¼ï¼‰

~/.local/bin/
â”œâ”€â”€ claude-notification-dynamic.sh      # é€šçŸ¥ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
â””â”€â”€ claude-complete-notify.sh           # å›ºå®šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆå¾Œæ–¹äº’æ›æ€§ã®ãŸã‚ï¼‰

~/.claude/
â””â”€â”€ settings.json                        # Claude Codeè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
```

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

```bash
# ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³
git clone https://github.com/s2atoru/claude-tmux-idle-notification-hook.git
cd claude-tmux-idle-notification-hook

# ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
mkdir -p ~/.local/bin
cp tmux-idle-check.sh tmux-idle-check-launcher.sh claude-notification-dynamic.sh ~/.local/bin/
chmod +x ~/.local/bin/{tmux-idle-check.sh,tmux-idle-check-launcher.sh,claude-notification-dynamic.sh}

# Claude Codeè¨­å®šã‚’ãƒãƒ¼ã‚¸
cat claude-settings-example.json >> ~/.claude/settings.json

# tmuxè¨­å®šã«è¿½åŠ ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
echo "set-hook -g after-new-session 'run-shell \"~/.local/bin/tmux-idle-check-launcher.sh\"'" >> ~/.tmux.conf

# tmuxè¨­å®šã‚’ãƒªãƒ­ãƒ¼ãƒ‰
tmux source-file ~/.tmux.conf
```

å®Œäº†ï¼tmuxã‚»ãƒƒã‚·ãƒ§ãƒ³ã§ã‚¢ã‚¤ãƒ‰ãƒ«çŠ¶æ…‹ã«ãªã‚‹ã¨é€šçŸ¥ãŒå±Šãã¾ã™ã€‚

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

### å‰ææ¡ä»¶

- macOS
- iTerm2ï¼ˆé€šçŸ¥æ©Ÿèƒ½ã«å¿…è¦ï¼‰
- tmux
- jqï¼ˆJSONè§£æç”¨ - `brew install jq`ï¼‰
- Claude Codeï¼ˆClaude Codeé€šçŸ¥æ©Ÿèƒ½ã‚’ä½¿ã†å ´åˆï¼‰

### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

#### 1. tmuxã‚¢ã‚¤ãƒ‰ãƒ«ç›£è¦–ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œå¯èƒ½ã«ã™ã‚‹
chmod +x tmux-idle-check.sh
chmod +x tmux-idle-check-launcher.sh

# ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’~/.local/binã«ã‚³ãƒ”ãƒ¼ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
mkdir -p ~/.local/bin
cp tmux-idle-check.sh ~/.local/bin/
cp tmux-idle-check-launcher.sh ~/.local/bin/
```

#### 2. Claude Codeé€šçŸ¥ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’~/.local/binã«é…ç½®
chmod +x claude-notification-dynamic.sh
cp claude-notification-dynamic.sh ~/.local/bin/

# Claude Codeè¨­å®šã«hookã‚’è¿½åŠ 
# ~/.claude/settings.jsonã«ä»¥ä¸‹ã‚’è¿½åŠ ï¼š
```

```json
{
  "hooks": {
    "Notification": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "~/.local/bin/claude-notification-dynamic.sh"
          }
        ]
      }
    ]
  }
}
```

### iTerm2è¨­å®š

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã¯iTerm2ã®Triggeræ©Ÿèƒ½ã‚’ä½¿ç”¨ã—ã¦macOSé€šçŸ¥ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ä»¥ä¸‹ã®æ‰‹é †ã§è¨­å®šã—ã¦ãã ã•ã„ã€‚

#### 1. Triggerã®è¨­å®š

1. iTerm2ã‚’é–‹ã
2. **iTerm2 > Settings > Profiles** ã‚’é–‹ã
3. ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ
4. **Advanced** ã‚¿ãƒ–ã‚’ã‚¯ãƒªãƒƒã‚¯
5. **Triggers** ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã® **Edit** ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
6. å·¦ä¸‹ã® **+** ãƒœã‚¿ãƒ³ã§æ–°ã—ã„Triggerã‚’è¿½åŠ 
7. ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šï¼š

| é …ç›® | è¨­å®šå€¤ |
|------|--------|
| Regular Expression | `^TMUX_IDLE_NOTIFICATION: (.*)$` |
| Name | `tmux idle notification` |
| Action | `Post Notification...` |
| Parameters | `\1` |
| Instant | âœ… ãƒã‚§ãƒƒã‚¯ |
| Enabled | âœ… ãƒã‚§ãƒƒã‚¯ |

8. **Close** ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ä¿å­˜

**é‡è¦**: `Parameters` ã® `\1` ã¯æ­£è¦è¡¨ç¾ã®ã‚­ãƒ£ãƒ—ãƒãƒ£ã‚°ãƒ«ãƒ¼ãƒ—ã‚’å‚ç…§ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚³ãƒ­ãƒ³ã®å¾Œã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å†…å®¹ãŒé€šçŸ¥ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

![iTerm2 Triggerè¨­å®šä¾‹](iterm2-trigger-settings.png)

#### 2. é€šçŸ¥æ¨©é™ã®ç¢ºèª

macOSã®ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã§ã€iTerm2ã®é€šçŸ¥ãŒè¨±å¯ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªï¼š

1. **ã‚·ã‚¹ãƒ†ãƒ è¨­å®š > é€šçŸ¥** ã‚’é–‹ã
2. **iTerm2** ã‚’é¸æŠ
3. **é€šçŸ¥ã‚’è¨±å¯** ãŒã‚ªãƒ³ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª
4. é€šçŸ¥ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ **ãƒãƒŠãƒ¼** ã¾ãŸã¯ **é€šçŸ¥** ã«è¨­å®š

## ä½¿ã„æ–¹

### tmuxã‚¢ã‚¤ãƒ‰ãƒ«ç›£è¦–

#### è‡ªå‹•èµ·å‹•ï¼ˆæ¨å¥¨ï¼‰

`.tmux.conf`ã«ä»¥ä¸‹ã‚’è¿½åŠ ã—ã¦ã€tmuxèµ·å‹•æ™‚ã«è‡ªå‹•å®Ÿè¡Œï¼š

```bash
# tmuxèµ·å‹•æ™‚ã«ã‚¢ã‚¤ãƒ‰ãƒ«ãƒã‚§ãƒƒã‚¯ã‚’é–‹å§‹
set-hook -g after-new-session 'run-shell "~/.local/bin/tmux-idle-check-launcher.sh"'
```

#### æ‰‹å‹•èµ·å‹•

```bash
# ãƒ©ãƒ³ãƒãƒ£ãƒ¼çµŒç”±ã§èµ·å‹•ï¼ˆé‡è¤‡èµ·å‹•ã‚’é˜²ãï¼‰
~/.local/bin/tmux-idle-check-launcher.sh

# ã¾ãŸã¯ç›´æ¥èµ·å‹•
nohup ~/.local/bin/tmux-idle-check.sh > /dev/null 2>&1 &
```

#### ãƒ—ãƒ­ã‚»ã‚¹ç¢ºèª

```bash
# å®Ÿè¡Œä¸­ã®ã‚¢ã‚¤ãƒ‰ãƒ«ãƒã‚§ãƒƒã‚¯ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç¢ºèª
pgrep -f "tmux-idle-check.sh"

# ãƒ—ãƒ­ã‚»ã‚¹è©³ç´°ã‚’ç¢ºèª
ps aux | grep tmux-idle-check
```

### Claude Codeé€šçŸ¥

Claude Codeã§ä½œæ¥­ã‚’å®Œäº†å¾Œã€60ç§’é–“ä½•ã‚‚å…¥åŠ›ã—ãªã„ã¨è‡ªå‹•çš„ã«é€šçŸ¥ãŒå±Šãã¾ã™ã€‚

#### æ‰‹å‹•ãƒ†ã‚¹ãƒˆ

```bash
# ãƒ†ã‚¹ãƒˆ1: idle_promptï¼ˆã‚¿ã‚¹ã‚¯å®Œäº†ï¼‰
tmux display-message "TMUX_IDLE_NOTIFICATION: Task completed - ready for input"

# ãƒ†ã‚¹ãƒˆ2: permission_promptï¼ˆå¿œç­”å¿…è¦ï¼‰
tmux display-message "TMUX_IDLE_NOTIFICATION: Your response needed"

# ã¾ãŸã¯ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ç›´æ¥JSONã‚’æ¸¡ã—ã¦ãƒ†ã‚¹ãƒˆ
echo '{"notification_type":"idle_prompt"}' | ~/.local/bin/claude-notification-dynamic.sh
```

Macå´ã§å¯¾å¿œã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é€šçŸ¥ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°æ­£å¸¸ã«å‹•ä½œã—ã¦ã„ã¾ã™ã€‚

## ã‚¹ã‚¯ãƒªãƒ—ãƒˆè©³ç´°

### tmux-idle-check.sh

tmuxã‚»ãƒƒã‚·ãƒ§ãƒ³ã®æœ€çµ‚ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’ç›£è¦–ã™ã‚‹ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€‚

**è¨­å®šå¯èƒ½ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:**

- `IDLE_THRESHOLD`: ã‚¢ã‚¤ãƒ‰ãƒ«åˆ¤å®šæ™‚é–“ï¼ˆç§’ï¼‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 60ç§’
- `sleep`: ãƒã‚§ãƒƒã‚¯é–“éš”ï¼ˆç§’ï¼‰ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 30ç§’

**å‹•ä½œ:**

1. 30ç§’ã”ã¨ã«tmuxã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚’ãƒã‚§ãƒƒã‚¯
2. 60ç§’ä»¥ä¸Šã‚¢ã‚¤ãƒ‰ãƒ«çŠ¶æ…‹ãŒç¶šãã¨é€šçŸ¥
3. ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã«æˆ»ã‚‹ã¨ãƒ•ãƒ©ã‚°ã‚’ãƒªã‚»ãƒƒãƒˆ
4. ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒçµ‚äº†ã™ã‚‹ã¨è‡ªå‹•çµ‚äº†

### tmux-idle-check-launcher.sh

ã‚¢ã‚¤ãƒ‰ãƒ«ãƒã‚§ãƒƒã‚¯ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®é‡è¤‡èµ·å‹•ã‚’é˜²ããƒ©ãƒ³ãƒãƒ£ãƒ¼ã€‚

**å‹•ä½œ:**

1. æ—¢ã«èµ·å‹•ä¸­ã‹ãƒã‚§ãƒƒã‚¯ï¼ˆ`pgrep`ã‚’ä½¿ç”¨ï¼‰
2. èµ·å‹•ã—ã¦ã„ãªã‘ã‚Œã°`nohup`ã§ç‹¬ç«‹ãƒ—ãƒ­ã‚»ã‚¹ã¨ã—ã¦èµ·å‹•
3. `disown`ã§ã‚·ã‚§ãƒ«ã‹ã‚‰åˆ‡ã‚Šé›¢ã—

### claude-notification-dynamic.shï¼ˆæ¨å¥¨ï¼‰

Claude Code hookç”¨ã®å‹•çš„é€šçŸ¥ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€‚é€šçŸ¥ã‚¿ã‚¤ãƒ—ã«å¿œã˜ã¦ç•°ãªã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

**æ©Ÿèƒ½:**

- Claude Code hookã‹ã‚‰JSONå½¢å¼ã®å…¥åŠ›ã‚’å—ã‘å–ã‚‹
- `notification_type`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’è§£æã—ã¦ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
- é€šçŸ¥ã‚¿ã‚¤ãƒ—ã”ã¨ã«é©åˆ‡ãªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆ

**é€šçŸ¥ã‚¿ã‚¤ãƒ—ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸:**

| é€šçŸ¥ã‚¿ã‚¤ãƒ— | è¡¨ç¤ºãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ | ç™ºç«æ¡ä»¶ |
|-----------|--------------|---------|
| `idle_prompt` | `Task completed - ready for input` | Claude CodeãŒã‚¿ã‚¹ã‚¯å®Œäº†å¾Œã‚¢ã‚¤ãƒ‰ãƒ«çŠ¶æ…‹ |
| `permission_prompt` | `Your response needed` | è³ªå•å¾…ã¡ãƒ»æ¨©é™ç¢ºèªãŒå¿…è¦ |

**å‹•ä½œ:**

- tmuxç’°å¢ƒå†…: `jq`ã§JSONã‚’è§£æã—ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡
- tmuxå¤–: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºåŠ›

**ä¾å­˜é–¢ä¿‚:**

- `jq`: JSONè§£æã«å¿…è¦ï¼ˆ`brew install jq`ï¼‰

### claude-complete-notify.shï¼ˆãƒ¬ã‚¬ã‚·ãƒ¼ï¼‰

Claude Code hookç”¨ã®å›ºå®šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€šçŸ¥ã‚¹ã‚¯ãƒªãƒ—ãƒˆã€‚å¾Œæ–¹äº’æ›æ€§ã®ãŸã‚ã«æ®‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

**å‹•ä½œ:**

- tmuxç’°å¢ƒå†…: ç¾åœ¨ã®ãƒšã‚¤ãƒ³ã«`TMUX_IDLE_NOTIFICATION: Claude Code task completed`ã‚’é€ä¿¡
- tmuxå¤–: `echo`ã§å‡ºåŠ›

**ç’°å¢ƒæ¤œå‡º:**

- `$TMUX`ç’°å¢ƒå¤‰æ•°ã®æœ‰ç„¡ã§tmuxç’°å¢ƒã‚’åˆ¤å®š
- ç¾åœ¨ã®ãƒšã‚¤ãƒ³IDã‚’è‡ªå‹•å–å¾—

**æ³¨æ„:** æ–°è¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ã¯`claude-notification-dynamic.sh`ã®ä½¿ç”¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚

## é€šçŸ¥ã®ä»•çµ„ã¿

### TMUX_IDLE_NOTIFICATION: ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹

iTerm2ã¯tmuxã®`display-message`å‡ºåŠ›ã‚’ç›£è¦–ã—ã€`TMUX_IDLE_NOTIFICATION:`ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’æ¤œå‡ºã™ã‚‹ã¨è‡ªå‹•çš„ã«macOSé€šçŸ¥ã«å¤‰æ›ã—ã¾ã™ã€‚

**ä¾‹:**

```bash
tmux display-message -t $PANE_ID "TMUX_IDLE_NOTIFICATION: Session idle for 1 minutes"
```

â†“

macOSé€šçŸ¥ã‚»ãƒ³ã‚¿ãƒ¼ã«ã€ŒSession idle for 1 minutesã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹

## å®Ÿè£…ãƒãƒ¼ãƒˆ

### Claude Code Notificationã‚¤ãƒ™ãƒ³ãƒˆã«ã¤ã„ã¦

`claude-notification-dynamic.sh` ã¯ä»¥ä¸‹ã®é€šçŸ¥ã‚¿ã‚¤ãƒ—ã«å¯¾å¿œã—ã¦ã„ã¾ã™ï¼š

- **`idle_prompt`**: ã‚¢ã‚¤ãƒ‰ãƒ«çŠ¶æ…‹ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›å¾…ã¡ â†’ "Task completed - ready for input"
- **`permission_prompt`**: æ¨©é™ç¢ºèªã‚„è³ªå•å¾…ã¡ â†’ "Your response needed"

ãƒ¯ã‚¤ãƒ«ãƒ‰ã‚«ãƒ¼ãƒ‰ãƒãƒƒãƒãƒ£ãƒ¼ï¼ˆ`*`ï¼‰ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€å°†æ¥çš„ã«æ–°ã—ã„é€šçŸ¥ã‚¿ã‚¤ãƒ—ãŒè¿½åŠ ã•ã‚ŒãŸå ´åˆã§ã‚‚ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®caseæ–‡ã‚’ç·¨é›†ã™ã‚‹ã ã‘ã§å¯¾å¿œã§ãã¾ã™ã€‚

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### é€šçŸ¥ãŒå±Šã‹ãªã„

**åŸå› 1: iTerm2ã‚’ä½¿ç”¨ã—ã¦ã„ãªã„**
- è§£æ±ºç­–: iTerm2ã§tmuxã‚’èµ·å‹•ã—ã¦ãã ã•ã„

**åŸå› 2: tmuxç’°å¢ƒã§ã¯ãªã„**
- è§£æ±ºç­–: tmuxå†…ã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„

**åŸå› 3: macOSé€šçŸ¥è¨­å®š**
- è§£æ±ºç­–: ã‚·ã‚¹ãƒ†ãƒ ç’°å¢ƒè¨­å®š > é€šçŸ¥ > iTerm2ã§é€šçŸ¥ãŒæœ‰åŠ¹ã‹ç¢ºèª

### ã‚¢ã‚¤ãƒ‰ãƒ«ãƒã‚§ãƒƒã‚¯ãŒå‹•ä½œã—ãªã„

**åŸå› 1: ãƒ—ãƒ­ã‚»ã‚¹ãŒèµ·å‹•ã—ã¦ã„ãªã„**

```bash
# ãƒ—ãƒ­ã‚»ã‚¹ç¢ºèª
pgrep -f "tmux-idle-check.sh"

# å†èµ·å‹•
~/.local/bin/tmux-idle-check-launcher.sh
```

**åŸå› 2: ã‚»ãƒƒã‚·ãƒ§ãƒ³åãŒå–å¾—ã§ããªã„**

```bash
# ç¾åœ¨ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³åã‚’ç¢ºèª
tmux display-message -p '#S'
```

### Claude Codeé€šçŸ¥ãŒå‹•ä½œã—ãªã„

**åŸå› 1: hookè¨­å®šãŒåæ˜ ã•ã‚Œã¦ã„ãªã„**

```bash
# Claude Codeè¨­å®šã‚’ç¢ºèª
cat ~/.claude/settings.json

# Claude Codeã‚’å†èµ·å‹•
```

**åŸå› 2: ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œæ¨©é™ãŒãªã„**

```bash
# å®Ÿè¡Œæ¨©é™ã‚’ä»˜ä¸
chmod +x ~/.local/bin/claude-notification-dynamic.sh
```

**åŸå› 3: ã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ‘ã‚¹ãŒé–“é•ã£ã¦ã„ã‚‹**

```bash
# ãƒ‘ã‚¹ã‚’ç¢ºèª
ls -la ~/.local/bin/claude-notification-dynamic.sh
```

**åŸå› 4: jqãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„**

```bash
# jqã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
brew install jq

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
which jq
```

## ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### ã‚¢ã‚¤ãƒ‰ãƒ«æ™‚é–“ã‚’å¤‰æ›´

`tmux-idle-check.sh`ã®`IDLE_THRESHOLD`ã‚’ç·¨é›†ï¼š

```bash
# ä¾‹: 120ç§’ï¼ˆ2åˆ†ï¼‰ã«å¤‰æ›´
IDLE_THRESHOLD=120
```

### é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å¤‰æ›´

`claude-notification-dynamic.sh`ã®`case`æ–‡ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºï¼š

```bash
# ä¾‹: æ—¥æœ¬èªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¤‰æ›´
case "$NOTIFICATION_TYPE" in
  "idle_prompt")
    CUSTOM_MSG="ã‚¿ã‚¹ã‚¯å®Œäº† - å…¥åŠ›å¾…ã¡"
    ;;
  "permission_prompt")
    CUSTOM_MSG="å¿œç­”ãŒå¿…è¦ã§ã™"
    ;;
  *)
    CUSTOM_MSG="$MESSAGE"
    ;;
esac
```

ã¾ãŸã¯ã€`tmux-idle-check.sh`ã®é€šçŸ¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸éƒ¨åˆ†ã‚’ç›´æ¥ç·¨é›†ï¼š

```bash
# ä¾‹:
tmux display-message -t "$PANE_ID" "TMUX_IDLE_NOTIFICATION: ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"
```

### ãƒã‚§ãƒƒã‚¯é–“éš”ã‚’å¤‰æ›´

`tmux-idle-check.sh`ã®`sleep`ã‚’ç·¨é›†ï¼š

```bash
# ä¾‹: 10ç§’ã”ã¨ã«ãƒã‚§ãƒƒã‚¯
sleep 10
```

## ä»Šå¾Œã®æ”¹å–„æ¡ˆ

### Claude Codeé€šçŸ¥ã®æ”¹å–„

ç¾åœ¨ã®`claude-complete-notify.sh`ã¯tmuxç’°å¢ƒã§ã®ã¿å‹•ä½œã—ã¾ã™ã€‚ä»¥ä¸‹ã®ç’°å¢ƒã«ã‚‚å¯¾å¿œã™ã‚‹æ”¹å–„æ¡ˆãŒã‚ã‚Šã¾ã™ï¼š

| ç’°å¢ƒ | ç¾çŠ¶ | æ”¹å–„æ¡ˆ |
|------|------|--------|
| tmux + iTerm2 | âœ… å‹•ä½œä¸­ | `TMUX_IDLE_NOTIFICATION:` |
| iTerm2ã®ã¿ | âŒ æœªå¯¾å¿œ | ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ `\e]9;ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸\a` |
| ãã®ä»– | âŒ æœªå¯¾å¿œ | `osascript` ã§ç›´æ¥é€šçŸ¥ |

> ğŸ’¡ **è¨ˆç”»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: è©³ç´°ãªå®Ÿè£…è¨ˆç”»ã¯ [Plans](/.claude/plans/) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

## è²¢çŒ®

è²¢çŒ®ã‚’æ­“è¿ã—ã¾ã™ï¼ä»¥ä¸‹ã®æ–¹æ³•ã§å‚åŠ ã§ãã¾ã™ï¼š

1. ğŸ› **ãƒã‚°å ±å‘Š**: [Issues](https://github.com/s2atoru/claude-tmux-idle-notification-hook/issues) ã§å ±å‘Š
2. ğŸ’¡ **æ©Ÿèƒ½ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**: [Issues](https://github.com/s2atoru/claude-tmux-idle-notification-hook/issues) ã§ææ¡ˆ
3. ğŸ”§ **ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**: æ”¹å–„ã‚’ç›´æ¥æå‡º
4. â­ **ã‚¹ã‚¿ãƒ¼**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒå½¹ç«‹ã£ãŸã‚‰ã‚¹ã‚¿ãƒ¼ã‚’ãŠé¡˜ã„ã—ã¾ã™

### é–‹ç™ºã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

- ã‚³ãƒ¼ãƒ‰ã‚¹ã‚¿ã‚¤ãƒ«: ShellCheckæº–æ‹ 
- ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: [Conventional Commits](https://www.conventionalcommits.org/)å½¢å¼
- ãƒ†ã‚¹ãƒˆ: å¤‰æ›´å‰å¾Œã§ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

## ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

MIT License

## ä½œè€…

sugimoto

[@s2atoru](https://github.com/s2atoru)

## å‚è€ƒè³‡æ–™

- [iTerm2 Proprietary Escape Codes](https://iterm2.com/documentation-escape-codes.html)
- [tmux man page](https://man.openbsd.org/tmux)
- [Claude Code Documentation](https://code.claude.com/docs)
